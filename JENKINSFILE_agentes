
pipeline {
agent any
stages {
        stage('Get Code') {
		agent { label 'SecundarioA' }
        	steps {
               		// Obtener c√≥digo del repo
			bat 'whoami'
                	git 'https://github.com/naxo1979/RepoDevOpsIPY_PUB'
			stash includes: '/app/**', name: 'app'
			stash includes: '/test/**', name: 'test'
            	}
        }

        stage('Build') {
		agent { label 'SecundarioB' }
		steps {
			bat 'whoami'
              		echo 'Eyyy, esto es Python. No hay que compilar nada!!!'
	          	echo WORKSPACE
              		bat 'dir'
           }
        }

        stage('Unit') {
		agent { label 'SecundarioA' }
            	steps {
                	catchError(buildResult: 'UNSTABLE', stageResult: 'FAILURE') {
                    	bat '''
                        set PYTHONPATH=%WORKSPACE%
                        pytest --junitxml=result-unit.xml test\\unit
	                '''
               }
            }
        }
}
}
